# This file was created for <%= node.name %>
# by Chef
# Manual changes will be lost

<% # unless templating via a role, use a sane set of defaults -%>
<% if node['logstash']['agent']['inputs'].empty? %>

input {

  file {
    type => "sample-logs"
    path => ["/var/log/*.log"]
    exclude => ["*.gz"]
    debug => true
  }

}

<% else -%>

input {
<%= hash_to_stash(node['logstash']['agent']['inputs']) %>
}

<% end -%>

<% unless  node['logstash']['agent']['filters'].empty? -%>
filter {
   <%= hash_to_stash(node['logstash']['agent']['filters'])%>
}
<% end -%>

<% if node['logstash']['agent']['outputs'].empty? %>
output {
  stdout { }
<% if @logstash_server_ip.empty? -%>
  # Provide a sane default
  null { }
<% else -%>
  tcp { host => "<%= @logstash_server_ip %>" port => "5959" }
<% end -%>
}

<% else -%>
output {
   <%= hash_to_stash(node['logstash']['agent']['outputs']) %>
}

<% end -%>
